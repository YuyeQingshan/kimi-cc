# kimi-cc

一个 oh-my-zsh 插件，让你用 Kimi K2 (Moonshot) 运行 Claude Code。

## 快速开始

### 安装插件

```bash
# 1. 克隆到插件目录
git clone https://github.com/your-username/kimi-cc.git ~/.oh-my-zsh/custom/plugins/kimi-cc

# 2. 在 ~/.zshrc 中启用插件
plugins=(... kimi-cc)

# 3. 重新加载配置
source ~/.zshrc
```

### 设置 Token

```bash
# 设置你的 API Token
kimi-cc-set-token your_token_here

# 开始使用
kimi-cc
```

## 基本使用

| 命令 | 功能 |
|------|------|
| `kimi-cc` | 启动 Claude Code |
| `kimi-cc-set-token <token>` | 设置 API Token |
| `kimi-cc-set-url <url>` | 设置自定义 API 地址 |
| `kimi-cc-config` | 查看配置状态 |
| `kimi-cc-help` | 查看帮助 |

### 示例

```bash
# 设置 token
kimi-cc-set-token sk-your-token-here

# 查看配置
kimi-cc-config

# 启动 Claude Code
kimi-cc

# 传递参数给 Claude Code
kimi-cc --version
```

## 全局模式

全局模式让所有 `claude` 命令都使用 Kimi 服务，无需 `kimi-cc` 前缀。

### 启用全局模式

```bash
kimi-cc-enable-global
```

### 管理全局模式

| 命令 | 功能 |
|------|------|
| `kimi-cc-enable-global` | 启用全局模式 |
| `kimi-cc-disable-global` | 禁用全局模式 |
| `kimi-cc-global-status` | 查看全局模式状态 |

启用后，直接用 `claude` 命令就行：

```bash
# 启用全局模式后
claude  # 等同于 kimi-cc
```

## 配置详情

### Token 设置

**推荐方式：用命令设置**
```bash
kimi-cc-set-token your_token_here
```

**手动方式：编辑配置文件**
```bash
# 编辑 ~/.kimiccrc
export KIMI_CC_AUTH_TOKEN="your_token_here"
```

### API 地址设置

```bash
# 使用默认 Moonshot 地址（无需设置）
# 默认：https://api.moonshot.cn/anthropic/

# 设置自定义地址
kimi-cc-set-url https://your-custom-api.com

# 使用官方 Anthropic API
kimi-cc-set-url https://api.anthropic.com
```

### 配置文件

插件使用 `~/.kimiccrc` 存储配置：

```bash
# Kimi Claude Code Configuration
# Generated by kimi-cc plugin

export KIMI_CC_AUTH_TOKEN="your_token_here"
export KIMI_CC_BASE_URL="https://custom-api.com"  # 可选
```

## 工作原理

### 普通模式
- 在子进程中设置环境变量，不影响全局环境
- 只有 `kimi-cc` 命令使用 Kimi 服务

### 全局模式
- 设置全局环境变量 `ANTHROPIC_AUTH_TOKEN` 和 `ANTHROPIC_BASE_URL`
- 所有 `claude` 命令都使用 Kimi 服务
- 两种触发方式：手动启用或检测到 `KIMI_CC_AUTH_TOKEN` 环境变量

### 自动检测逻辑
代码会自动检测 `KIMI_CC_AUTH_TOKEN` 环境变量：
- 如果存在且未启用任何全局模式 → 自动启用自动全局模式
- 手动全局模式优先级更高

## 环境变量

| 变量 | 说明 |
|------|------|
| `KIMI_CC_AUTH_TOKEN` | 你的 API Token（必需） |
| `KIMI_CC_BASE_URL` | API 地址（可选，默认 Moonshot） |
| `ANTHROPIC_AUTH_TOKEN` | 全局模式下的 Claude Token |
| `ANTHROPIC_BASE_URL` | 全局模式下的 Claude API 地址 |

## 常见问题

### 没有 claude 命令？

```bash
npm install -g @anthropic-ai/claude-code
```

### Token 未设置？

```bash
# 用命令设置
kimi-cc-set-token your_token_here

# 或手动编辑 ~/.kimiccrc
export KIMI_CC_AUTH_TOKEN="your_token_here"
```

### 全局模式不生效？

```bash
# 检查状态
kimi-cc-global-status

# 手动启用
kimi-cc-enable-global

# 检查配置
kimi-cc-config
```

### 环境变量冲突？

```bash
# 查看当前环境变量
kimi-cc-config

# 查看配置文件
cat ~/.kimiccrc

# 禁用全局模式
kimi-cc-disable-global
```

## 许可证

MIT License
